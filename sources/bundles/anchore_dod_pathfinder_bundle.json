{
    "blacklisted_images": [], 
    "description": "Anchore DoD Pathfinder Docker image content checks", 
    "id": "anchore_DoD_pathfinder_base", 
    "last_updated": 1548806465, 
    "mappings": [
        {
            "comment": "default mapping that matches all registry/repo:tag images", 
            "id": "042d5b75-ed9d-4fb7-8d41-ec174102f696", 
            "image": {
                "type": "tag", 
                "value": "*"
            }, 
            "name": "default", 
            "policy_ids": [
                "4f3bdc23-175b-4582-8c7d-3a7d8fa32a12", 
                "cb417967-266b-4453-bfb6-9acf67b0bee5", 
                "f2de1d56-c7f1-4b5a-92e0-135a27feae45"
            ], 
            "registry": "*", 
            "repository": "*", 
            "whitelist_ids": []
        }
    ], 
    "name": "anchore_DoD_pathfinder_base", 
    "policies": [
        {
            "comment": "Anchore DoD File Checks", 
            "id": "f2de1d56-c7f1-4b5a-92e0-135a27feae45", 
            "name": "File Checks", 
            "rules": [
                {
                    "action": "WARN", 
                    "comment": "Remove setuid and setgid permissions in the images", 
                    "gate": "files", 
                    "id": "41b657bb-86e5-43ba-8f35-18edc3a465f9", 
                    "params": [], 
                    "trigger": "suid_or_guid_set"
                }, 
                {
                    "action": "WARN", 
                    "comment": "Do not store secrets in Dockerfiles", 
                    "gate": "secret_scans", 
                    "id": "c0e5e302-764d-4b19-9fbd-5c7b0b558673", 
                    "params": [], 
                    "trigger": "content_regex_checks"
                }
            ], 
            "version": "1_0"
        }, 
        {
            "comment": "Anchore DoD Dockerfile checks.", 
            "id": "cb417967-266b-4453-bfb6-9acf67b0bee5", 
            "name": "Dockerfile Checks", 
            "rules": [
                {
                    "action": "WARN", 
                    "comment": "User COPY instruction instead of ADD instruction in the Dockerfile", 
                    "gate": "dockerfile", 
                    "id": "e9eacc50-aaac-4241-95ac-790cf0be84da", 
                    "params": [
                        {
                            "name": "instruction", 
                            "value": "ADD"
                        }, 
                        {
                            "name": "check", 
                            "value": "exists"
                        }
                    ], 
                    "trigger": "instruction"
                }, 
                {
                    "action": "WARN", 
                    "comment": "Do not user update instructions such as apt-get update alone or in a single line in the Dockerfile", 
                    "gate": "dockerfile", 
                    "id": "2f87d4bf-e963-496a-8b3d-ff90bef46014", 
                    "params": [
                        {
                            "name": "instruction", 
                            "value": "RUN"
                        }, 
                        {
                            "name": "check", 
                            "value": "like"
                        }, 
                        {
                            "name": "value", 
                            "value": "(\\s*/bin/sh\\s*-c\\s*)*\\s*apk.*up(date|grade)\\s*$"
                        }
                    ], 
                    "trigger": "instruction"
                }, 
                {
                    "action": "WARN", 
                    "comment": "Do not user update instructions such as apt-get update alone or in a single line in the Dockerfile", 
                    "gate": "dockerfile", 
                    "id": "ea1b1c11-0633-48cc-8afc-92b252f331b3", 
                    "params": [
                        {
                            "name": "instruction", 
                            "value": "RUN"
                        }, 
                        {
                            "name": "check", 
                            "value": "like"
                        }, 
                        {
                            "name": "value", 
                            "value": "(\\s*/bin/sh\\s*-c\\s*)*\\s*yum.*up(date|grade)\\s*$"
                        }
                    ], 
                    "trigger": "instruction"
                }, 
                {
                    "action": "WARN", 
                    "comment": "Do not user update instructions such as apt-get update alone or in a single line in the Dockerfile", 
                    "gate": "dockerfile", 
                    "id": "c5dbe7b8-b48b-4845-beff-069421d9d1ba", 
                    "params": [
                        {
                            "name": "instruction", 
                            "value": "RUN"
                        }, 
                        {
                            "name": "check", 
                            "value": "like"
                        }, 
                        {
                            "name": "value", 
                            "value": "(\\s*/bin/sh\\s*-c\\s*)*\\s*apt(-get)*.*up(date|grade)\\s*$"
                        }
                    ], 
                    "trigger": "instruction"
                }, 
                {
                    "action": "STOP", 
                    "comment": "Add HEALTHCHECK instruction in your Docker container images to perform the health check on running containers", 
                    "gate": "dockerfile", 
                    "id": "64499886-5917-4a41-b18b-7d2d0bdcf12b", 
                    "params": [
                        {
                            "name": "instruction", 
                            "value": "HEALTHCHECK"
                        }, 
                        {
                            "name": "check", 
                            "value": "not_exists"
                        }
                    ], 
                    "trigger": "instruction"
                },
                {
                    "action": "STOP", 
                    "comment": "Create a non-root user for the container in the Dockerfile for the container image", 
                    "gate": "dockerfile", 
                    "id": "c96bf84d-0e76-435c-a94c-0f556bbaf45f", 
                    "params": [
                        {
                            "name": "users", 
                            "value": "root,docker"
                        }, 
                        {
                            "name": "type", 
                            "value": "blacklist"
                        }
                    ], 
                    "trigger": "effective_user"
                }
            ], 
            "version": "1_0"
        }, 
        {
            "comment": "Anchore DoD Software Checks.", 
            "id": "4f3bdc23-175b-4582-8c7d-3a7d8fa32a12", 
            "name": "Software Checks", 
            "rules": [
                {
                    "action": "WARN", 
                    "comment": "Scan images frequently for any vulnerabilites. Rebuild the images to include patches and then instantiate new containers from it.", 
                    "gate": "vulnerabilities", 
                    "id": "8955f515-60e2-4483-bdf4-2fe475fe0c8c", 
                    "params": [
                        {
                            "name": "package_type", 
                            "value": "all"
                        }, 
                        {
                            "name": "severity_comparison", 
                            "value": "<="
                        }, 
                        {
                            "name": "severity", 
                            "value": "negligible"
                        }, 
                        {
                            "name": "vendor_only", 
                            "value": "true"
                        }
                    ], 
                    "trigger": "package"
                }, 
                {
                    "action": "STOP", 
                    "comment": "Scan images frequently for any vulnerabilites. Rebuild the images to include patches and then instantiate new containers from it.", 
                    "gate": "vulnerabilities", 
                    "id": "0821c410-b0d4-4a25-90d7-aa71b46d7e32", 
                    "params": [
                        {
                            "name": "package_type", 
                            "value": "all"
                        }, 
                        {
                            "name": "severity_comparison", 
                            "value": ">="
                        }, 
                        {
                            "name": "severity", 
                            "value": "low"
                        }, 
                        {
                            "name": "vendor_only", 
                            "value": "true"
                        }
                    ], 
                    "trigger": "package"
                }, 
                {
                    "action": "STOP", 
                    "comment": "Scan images frequently for any vulnerabilites. Rebuild the images to include patches and then instantiate new containers from it.", 
                    "gate": "vulnerabilities", 
                    "id": "211fa08b-e69a-4165-a0df-05cd3bd0e002", 
                    "params": [
                        {
                            "name": "package_type", 
                            "value": "all"
                        }, 
                        {
                            "name": "severity_comparison", 
                            "value": ">="
                        }, 
                        {
                            "name": "severity", 
                            "value": "unknown"
                        }, 
                        {
                            "name": "fix_available", 
                            "value": "true"
                        }
                    ], 
                    "trigger": "package"
                }, 
                {
                    "action": "STOP", 
                    "comment": "Scan images frequently for any vulnerabilites. Rebuild the images to include patches and then instantiate new containers from it.", 
                    "gate": "vulnerabilities", 
                    "id": "e3a73079-fe16-4de6-9b2f-3982277e57d5", 
                    "params": [
                        {
                            "name": "max_days_since_sync", 
                            "value": "2"
                        }
                    ], 
                    "trigger": "stale_feed_data"
                }, 
                {
                    "action": "STOP", 
                    "comment": "Scan images frequently for any vulnerabilites. Rebuild the images to include patches and then instantiate new containers from it.", 
                    "gate": "vulnerabilities", 
                    "id": "aeff8bdb-82b5-44fd-87ef-d8fdd50893e8", 
                    "params": [], 
                    "trigger": "vulnerability_data_unavailable"
                }
            ], 
            "version": "1_0"
        }
    ], 
    "version": "1_0", 
    "whitelisted_images": [], 
    "whitelists": []
}
